<pbs-navigation service-provider-id="$ctrl.serviceProviderId">
  <pbs-breadcrumb title="'Service Packs'"
    ng-click="$ctrl.open()"></pbs-breadcrumb>
  <pbs-breadcrumb title="$ctrl.servicePackName"></pbs-breadcrumb>
</pbs-navigation>

<pbs-tabs size="large">
  <pbs-tab label="Details">
    <pbs-spinner loading="$ctrl.loading">
      <pbs-block title="{{ $ctrl.servicePackName }}">
        <pbs-block-buttons>
          <pbs-button-compact-edit title="Edit Service Pack"
            ng-click="$ctrl.edit()"></pbs-button-compact-edit>
        </pbs-block-buttons>
        <pbs-list>
          <pbs-list-item label="Available For Use">
            <pbs-check-box checked="$ctrl.servicePack.isAvailableForUse"></pbs-check-box>
          </pbs-list-item>
          <pbs-list-item label="Description">
            {{ $ctrl.servicePack.servicePackDescription }}
          </pbs-list-item>
          <pbs-list-item label="Maximum Allowed">
            {{ $ctrl.quantity($ctrl.servicePack.allowedQuantity) }}
          </pbs-list-item>
          <pbs-list-item label="Limited To">
            {{ $ctrl.quantity($ctrl.servicePack.servicePackQuantity) }}
          </pbs-list-item>
          <pbs-list-item label="Allocated to Groups">
            {{ $ctrl.quantity($ctrl.servicePack.assignedQuantity) }}
          </pbs-list-item>
        </pbs-list>
      </pbs-block>
    </pbs-spinner>
  </pbs-tab>
  <pbs-tab label="Services">
    <pbs-spinner loading="$ctrl.loading">
      <pbs-table-search ng-model="$ctrl.filter"></pbs-table-search>
      <table pbs-table>
        <thead>
          <tr>
            <th>Service</th>
            <th>Authorized</th>
            <th>Allocated</th>
            <th>Available</th>
          </tr>
        </thead>
        <tfoot>
          <tr ng-if="results.length < 1">
            <td colspan="4">No Service Found
              <span ng-if="$ctrl.filter">for {{ $ctrl.filter }}</span>
            </td>
          </tr>
        </tfoot>
        <tbody>
          <tr ng-repeat="service in $ctrl.servicePack.userServices | filter:$ctrl.filter | orderBy:'serviceName' as results track by service.serviceName">
            <td>{{ service.serviceName }}</td>
            <td>{{ service.authorized === -1 ? 'Unlimited' : service.authorized }}</td>
            <td>{{ service.allocated === -1 ? 'Unlimited' : service.allocated }}</td>
            <td>{{ service.available === -1 ? 'Unlimited' : service.available }}</td>
          </tr>
        </tbody>
      </table>
    </pbs-spinner>
  </pbs-tab>
</pbs-tabs>
<pbs-modal id="editServicePack"
  title="Edit Service Pack">
  <pbs-form>
    <pbs-form-field label="Name">
      <input type="text"
        class="input"
        ng-model="$ctrl.editServicePack.newServicePackName">
    </pbs-form-field>
    <pbs-form-field label="Description">
      <input type="text"
        class="input"
        ng-model="$ctrl.editServicePack.servicePackDescription">
    </pbs-form-field>
    <pbs-form-field label="Available For Use">
      <label class="checkbox">
        <input type="checkbox"
          ng-model="$ctrl.editServicePack.isAvailableForUse"> Available For Use
      </label>
    </pbs-form-field>
    <pbs-form-field label="Limit">
      <small>Available: {{ $ctrl.quantity($ctrl.servicePack.allowedQuantity) }}</small>
      <input type="number"
        class="input"
        ng-model="$ctrl.editServicePack.servicePackQuantity"
        min="{{ $ctrl.isUnlimited() ? -1 : 1 }}"
        max="{{ $ctrl.isUnlimited() ? 999999 : $ctrl.servicePack.allowedQuantity }}"
        required>
      <span ng-show="$ctrl.isUnlimited()">
        <small ng-show="$ctrl.editServicePack.servicePackQuantity === -1">
          <strong>Unlimited</strong>
        </small>
        <small ng-show="$ctrl.editServicePack.servicePackQuantity !== -1">
          Set to -1 for Unlimited
        </small>
      </span>
    </pbs-form-field>
  </pbs-form>
</pbs-modal>
