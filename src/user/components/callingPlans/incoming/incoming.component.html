<pbs-spinner loading="$ctrl.loading">
  <pbs-block title="Incoming Calling Plan">
    <pbs-block-buttons>
      <pbs-button-compact-edit title="Incoming Calling Plan"
        ng-click="$ctrl.edit()"
        ng-if="!$ctrl.readOnly">
      </pbs-button-compact-edit>
    </pbs-block-buttons>
    <pbs-list>
      <pbs-list-section>Custom Settings</pbs-list-section>
      <pbs-list-item label="Use Custom Settings">
        <pbs-check-box checked="$ctrl.plan.useCustomSettings"></pbs-check-box>
      </pbs-list-item>
      <pbs-list-section>Permissions</pbs-list-section>
      <pbs-list-item label="Allow Inside Calls">
        <pbs-check-box checked="$ctrl.plan.userPermissions.allowFromWithinGroup"></pbs-check-box>
      </pbs-list-item>
      <pbs-list-item label="Allow Outside Calls">
        {{ $ctrl.plan.userPermissions.allowFromOutsideGroup }}
      </pbs-list-item>
      <pbs-list-item label="Allow Collect Calls">
        <pbs-check-box checked="$ctrl.plan.userPermissions.allowCollectCalls"></pbs-check-box>
      </pbs-list-item>
      <pbs-list-section>Digit Patterns</pbs-list-section>
      <pbs-list-item label="{{ pattern.digitPatternName }}"
        ng-repeat="pattern in $ctrl.plan.userPermissions.digitPatterns track by pattern.digitPatternName">
        <pbs-check-box checked="pattern.allow"></pbs-check-box>
      </pbs-list-item>
    </pbs-list>
  </pbs-block>
</pbs-spinner>
<pbs-modal id="editUserIncomingPlan"
  title="Edit Incoming Calling Plan">
  <pbs-form>
    <pbs-form-section>Custom Settings</pbs-form-section>
    <input type="checkbox"
      label="Use Custom Settings"
      ng-model="$ctrl.editPlan.useCustomSettings"
      pbs-input-checkradio>

    <div ng-show="$ctrl.editPlan.useCustomSettings">
      <pbs-form-section>Permissions</pbs-form-section>
      <input type="checkbox"
        ng-model="$ctrl.editPlan.userPermissions.allowFromWithinGroup"
        label="Allow Inside Calls"
        pbs-input-checkradio>
      <input type="checkbox"
        ng-model="$ctrl.editPlan.userPermissions.allowCollectCalls"
        label="Allow Collect Calls"
        pbs-input-checkradio>
      <pbs-form-field label="Allow Outside Calls">
        <div class="select">
          <select ng-model="$ctrl.editPlan.userPermissions.allowFromOutsideGroup"
            ng-options="opt for opt in $ctrl.options.allowFromOutsideGroup"></select>
        </div>
      </pbs-form-field>
      <pbs-form-section>Digit Patterns</pbs-form-section>
      <input type="checkbox"
        ng-repeat="pattern in $ctrl.editPlan.userPermissions.digitPatterns track by pattern.digitPatternName"
        label="Allow {{ pattern.digitPatternName }}"
        ng-model="pattern.allow"
        pbs-input-checkradio>
    </div>
  </pbs-form>
</pbs-modal>
